import pytesseract
import cv2
import pyttsx3

# Initialize TTS engine
engine = pyttsx3.init()
engine.setProperty('rate', 125)  # Set speech rate

# Open webcam
webcam = cv2.VideoCapture(0)

print("Press 'z' to capture and process the image or 'q' to quit.")

while True:
    try:
        # Capture frame from webcam
        ret, frame = webcam.read()
        if not ret:
            print("Failed to capture image.")
            break
        
        # Display the live video feed
        cv2.imshow("Live OCR Feed", frame)
        
        # Check for key press
        key = cv2.waitKey(1)
        
        if key == ord('z'):  # Capture image and process it
            # Convert frame to grayscale (optional, improves OCR)
            gray_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
            
            # Perform OCR on the captured frame
            text = pytesseract.image_to_string(gray_frame)
            print("Text Detected:")
            print(text)
            
            # Speak the detected text
            engine.say("Here is the text I read.")
            engine.say(text)
            engine.runAndWait()
            
        elif key == ord('q'):  # Quit the program
            print("Exiting the program.")
            break

    except KeyboardInterrupt:
        print("Interrupted by user.")
        break

# Release resources
webcam.release()
cv2.destroyAllWindows()
